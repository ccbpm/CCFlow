<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>流程待办</title>
		<!-- basic styles -->

		<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets/css/font-awesome.min.css" />

		<!--[if IE 7]>
		  <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
		<![endif]-->

		<!-- page specific plugin styles -->

		<!-- fonts -->

		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" />

		<!-- ace styles -->

		<link rel="stylesheet" href="assets/css/ace.min.css" />
		<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="assets/css/ace-skins.min.css" />

		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->

		<script src="assets/js/ace-extra.min.js"></script>

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

		<!--[if lt IE 9]>
		<script src="assets/js/html5shiv.js"></script>
		<script src="assets/js/respond.min.js"></script>
		<![endif]-->

    <script type="text/javascript" src="../WF/Scripts/bootstrap/js/jquery.min.js"></script>
    <script src="../../Scripts/QueryString.js" type="text/javascript"></script>
    <!-- 引用通用的js文件. -->
    <script type="text/javascript" src="../WF/Comm/Gener.js"></script>
    <script type="text/javascript" src="../WF/Scripts/config.js"></script>
    <script type="text/javascript" language="javascript" >
        //获取当前时间
        function getNowFormatDate() {
            var date = new Date();
            var seperator1 = "-";
            var seperator2 = ":";
            var month = date.getMonth() + 1;
            var strDate = date.getDate();
            if (month >= 1 && month <= 9) {
                month = "0" + month;
            }
            if (strDate >= 0 && strDate <= 9) {
                strDate = "0" + strDate;
            }
            //当前时间=年份-月份-日 小时：分钟
            var cdt = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + date.getHours() + seperator2 + date.getMinutes();

            return cdt;
        }


        //页面启动函数.
        $(function () {

         //随机串.
            var timeKey = Math.random(); 

            //初始化表格.
            $.ajax({
                type: 'post',
                async: true,
                url: Handler + "?DoType=Runing_Init&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {

                    if (data.indexOf('err@') == 0) {
                        alert(data);
                        return;
                    }


                    data = JSON.parse(data);

                    var newRow = "";
                    //增加处理.
                    for (var i = 0; i < data.length; i++) {

                        newRow += "<tr ><td class=Idx>" + i + "</td>";
                        newRow += "<td>" + "<a href=\"javascript:WinOpenIt('../WF/MyFlow.aspx?FK_Flow=" + data[i].FK_FLOW + "&FID=0&WorkID=" + data[i].WORKID + "&FK_Node=" + data[i].FK_FLOW + "01&IsRead=0&T=" + timeKey + "');\" >" + data[i].TITLE + "</a></td>";
                        newRow += "<td>" + data[i].FLOWNAME + "</td>";
                        newRow += "<td>" + data[i].STARTERNAME + "</td>";
                        newRow += "<td>" + data[i].NODENAME + "</td>";

                        newRow += "<td>" + data[i].RDT + "</td>";
                        newRow += "<td>";
                        newRow += "<a href=\"javascript:UnSend('" + data[i].WORKID + "')\"><img src='../../Img/Action/UnSend.png' border=0 />撤销</a>";
                        newRow += "<a href=\"javascript:Press('" + data[i].WORKID + "')\"><img src='../../Img/Action/Press.png' border=0 />催办</a>";
                        newRow += "</td>";
                        newRow += "</tr>";
                    }

                    $("#Rows").html(newRow);
                    return;
                }
             
            });
        });

        function Do(warning, url) {
            if (window.confirm(warning) == false)
                return;
            window.location.href = url;
        }
        // 撤销。
        function UnSend(appPath, pageID, fid, workid, fk_flow) {
            if (window.confirm('您确定要撤销本次发送吗？') == false)
                return;
            var url = appPath + 'WF/Do.aspx?DoType=UnSend&FID=' + fid + '&WorkID=' + workid + '&FK_Flow=' + fk_flow + '&PageID=' + pageID;
            window.location.href = url;
            return;
        }
        function Press(appPath, fid, workid, fk_flow) {
            var url = appPath + 'WF/WorkOpt/Press.htm?FID=' + fid + '&WorkID=' + workid + '&FK_Flow=' + fk_flow;
            var v = window.showModalDialog(url, 'sd', 'dialogHeight: 200px; dialogWidth: 350px;center: yes; help: no');
        }


        function WinOpenIt(url) {
            //窗口最大化e
            var scrWidth = screen.availWidth;
            var scrHeight = screen.availHeight;
            var self = window.open(url, '_blank', "resizable=1,scrollbars=yes");
            self.moveTo(0, 0);
            self.resizeTo(scrWidth, scrHeight);
            self.focus();
            return;
        }

        /* ESC Key Down */
        function Esc() {
            if (event.keyCode == 27)
                window.close();
            return true;
        }


        function OpenFlow(url) {
            window.open(url, "_");
            return;
        }
    </script>
	</head>
	<body>
		<div class="main-container" id="main-container">
					<div class="breadcrumbs" id="breadcrumbs">
						<ul class="breadcrumb">
							<li>
								<i class="icon-home home-icon"></i>
								<a href="welcome.htm">Home</a>
							</li>
							<li class="active">在途</li>
						</ul><!-- .breadcrumb -->

						<div class="nav-search" id="nav-search">
							<form class="form-search">
								<span class="input-icon">
									<input type="text" placeholder="查找 ..."  class="nav-search-input" id="nav-search-input" autocomplete="off" />
									<i class="icon-search nav-search-icon"></i>
								</span>
							</form>
						</div><!-- #nav-search -->
					</div>

						<div class="row">
							<div class="col-xs-12">
								<!-- PAGE CONTENT BEGINS -->

								<div class="row">
									<div class="col-xs-12">
										<div class="table-responsive">
											<table id="sample-table-1" class="table table-striped table-bordered table-hover">
												<thead>
                                                     
                                                     <tr>
<th>序</th>
<th>标题</th>
<th>流程</th>
<th>发起人</th>
<th>当前节点</th>
<th>发起日期</th>
<th>操作</th>
</tr>
													 
													</tr>
												</thead>

												<tbody id="Rows">
												</tbody>

											</table>
										</div><!-- /.table-responsive -->
									</div><!-- /span -->
								</div><!-- /row -->

								<div class="hr hr-18 dotted hr-double"></div>
							</div><!-- /.col -->
						</div><!-- /.row -->
		 
		</div><!-- /.main-container -->

		<!-- basic scripts -->

		<!--[if !IE]> -->

		<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

		<!-- <![endif]-->

		<!--[if IE]>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<![endif]-->

		<!--[if !IE]> -->

		<script type="text/javascript">
		    window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
		</script>

		<!-- <![endif]-->

		<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
 


</body>
</html>
