<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>注册</title>
   
    <!--<link href="css/themes/default/jquery.mobile-1.4.5.min.css" rel="stylesheet" type="text/css" />
    <link href="css/themes/classic/theme-classic.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery.mobile-1.4.5.min.js" type="text/javascript"></script>-->
    <link href="js/mui/css/mui.min.css" rel="stylesheet" type="text/css" />
    <link href="js/mui/css/style.css" rel="stylesheet" type="text/css" />
    <script src="./js/mui/js/mui.min.js" type="text/javascript"></script>
    
    
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/jquery.js" type="text/javascript"></script>
    
    <script src="./Scripts/config.js" type="text/javascript"></script>
    <script src="./Comm/Gener.js" type="text/javascript"></script>
    <style type="text/css">
    .mui-bar{ background-color:#007aff !important;}
		.mui-title{color:white !important;}
        .area {
				margin: 20px auto 0px auto;
			}
			
			.mui-input-group {
				margin-top: 10px;
			}
			
			.mui-input-group:first-child {
				margin-top: 20px;
			}
			
			.mui-input-group label {
				width: 22%;
			}
			
			.mui-input-row label~input,
			.mui-input-row label~select,
			.mui-input-row label~textarea {
				width: 78%;
			}
			
			.mui-checkbox input[type=checkbox],
			.mui-radio input[type=radio] {
				top: 6px;
			}
			
			.mui-content-padded {
				margin-top: 25px;
			}
			
			.mui-btn {
				padding: 10px;
			}
			
			.link-area {
				display: block;
				margin-top: 25px;
				text-align: center;
			}
			
			.spliter {
				color: #bbb;
				padding: 0px 8px;
			}
			
			.oauth-area {
				position: absolute;
				bottom: 20px;
				left: 0px;
				text-align: center;
				width: 100%;
				padding: 0px;
				margin: 0px;
			}
			
			.oauth-area .oauth-btn {
				display: inline-block;
				width: 50px;
				height: 50px;
				background-size: 30px 30px;
				background-position: center center;
				background-repeat: no-repeat;
				margin: 0px 20px;
				/*-webkit-filter: grayscale(100%); */
				border: solid 1px #ddd;
				border-radius: 25px;
			}
			
			.oauth-area .oauth-btn:active {
				border: solid 1px #aaa;
			}
			
			.oauth-area .oauth-btn.disabled {
				background-color: #ddd;
			}
    </style>
        <script src="js/mui/js/mui.min.js" type="text/javascript"></script>
    <script src="./Scripts/QueryString.js" type="text/javascript"></script> 
</head>
<body>
    <header class="mui-bar mui-bar-nav"  id='header'>
			<h1 class="mui-title" id='topTitle'>驰骋工作流软件</h1>
	</header>
        <div class="mui-content" id='div_list'>
			<form id='login-form' class="mui-input-group">
				<div class="mui-input-row">
					<input name="TB_No" id="TB_No" type="text" class="mui-input-clear mui-input" placeholder="请输入手机号">
				</div>
				<div class="mui-input-row">
					<input name="TB_PW" id="TB_PW" type="password" class="mui-input-clear mui-input" placeholder="请输入密码">
				</div>
			</form>
            <div class="mui-content-padded">
				<button id="logon" type="button" data-loading-icon="mui-spinner mui-spinner-custom"  class="mui-btn mui-btn-block mui-btn-primary">注册/登录</button>	
			</div>
			<div class="mui-content-padded oauth-area">

			</div>
        </div>
<script type="text/javascript" charset="utf-8">
    mui.init();
    mui.ready(//加载数据
			function Load_EmpWorks() {
				if(mui.os.android){ 	//注意，这里是小写的android

				}else{
					$("#header").css("height","95px");
					$("#topTitle").css("margin-top","45px");
					$("#aback").css("margin-top","45px");
					$("#div_list").css("margin-top","50px");

				}
    });

    //点击发起事件
    document.getElementById('logon').addEventListener('tap', function () {
    	logon();
    });

    function logon(){
    	console.log("正在进行，请稍候");
    	//1.表单验证
        var userNo = $("#TB_No").val();
    	var pwd=$("#TB_PW").val();
        var openid=GetQueryString("openid");
        if (userNo == null || userNo == '') {
            mui.toast('请输入手机号！', { duration: 'short', type: 'div' });
            //                mui.alert("请输入用户名！");
            return;
        }

        //2.登录提交验证
        //                var frmData = $("#loginfrm").serialize();
        var handler = new HttpHandler("BP.WF.HttpHandler.CCMobile");
        handler.AddPara("TB_No", userNo); 
        handler.AddPara("TB_PW",pwd);
        handler.AddPara("openid",openid);
        var data = handler.DoMethodReturnString("Login_Submit");

        if (data.indexOf('登录成功') >= 0) {
            location.href = './Home.htm?s=' + Math.random();
            return;
        }

        if (data.indexOf('err@') == 0) {
            mui.toast("未找到用户！", { duration: 'short', type: 'div' });
//            mui.alert(data);
            return;
        }

    }
</script>
</body>
</html>
