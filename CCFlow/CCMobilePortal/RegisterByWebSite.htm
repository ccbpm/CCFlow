<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>驰骋云平台</title>
    <script type="text/javascript" src="/WF/Scripts/jquery-1.7.2.min.js"></script>
    <script src="/CCMobile/Scripts/QueryString.js" type="text/javascript"></script>
    <script src="/CCMobile/Scripts/config.js" type="text/javascript"></script>
    <script src="/CCMobile/Comm/Gener.js" type="text/javascript"></script>
    <script src="/WF/Scripts/layui/layui/layui.js"></script>

    <!--mui的引用-->
    <link href="/CCMobile/css/index2.css" rel="stylesheet" type="text/css" />
    <link href="/CCMobile/js/mui/css/mui.min.css" rel="stylesheet" type="text/css" />
    <script src="/CCMobile/js/mui/js/mui.min.js" type="text/javascript"></script>

    <script type="text/javascript">

        function Save() {

            try {

                var orgNo = $("#TB_OrgNo").val();
                if (orgNo.length < 3) {
                    alert('机构编号太短.');
                    return;
                }

              //@gaoxin 需要出现等待窗口, 2020.09.26 

                //弹出的等待提示信息.
                var loading = layer.msg('正在为您初始化<br/>企业账户信息...', { icon: 16, shade: 0.3});

                //var html = "正在为您初始化企业账户信息，需要一袋烟的功夫，请稍候。";
                html += "<br>您可以使用 http://" + orgNo + ".ccbpm.cn 登录PC端，发起、处理待办、设计流程.";

                var handler = new HttpHandler("BP.Cloud.HttpHandler.Root");
                handler.AddFormData(); //复制表单的全部数据必须有name值.
                var data = handler.DoMethodReturnString("RegisterAdminer_Submit");
                if (data.indexOf('err@') == 0) {
                    alert(data);
                    return;
                }

                //alert(data + ".\t\n将要转入登录主页，请在系统管理菜单设计流程模版。");
                //alert(data + "请您填写企业账户信息.");
                SetHref( "Home.htm");

            } catch (e) {
                $("#Btn_Submit").val('注册');
                alert(e);
            }
        }
    </script>

    <style type="text/css">
        legend {
            font-size: larger;
            font-weight: bolder;
        }

        label.layui-form-label {
            width: 25%;
            text-align: left;
            margin-top: 15px;
        }

        .layui-form-item {
            margin-bottom: 0px;
            margin-top: 15px;
        }

        .point {
            font-size: 14px;
            color: #ababab;
        }

        .layui-form {
            background: #ffffff;
        }
    </style>

</head>

<body>
    <!--注册页面-->
    <form class="layui-form" id="zhou">

        <center>
            <table style="width:90%;border:0px;margin:0px 20px;">
                <tr>
                    <td colspan="2">
                        <div id="toolbar"></div>
                    </td>
                </tr>

                <tr style="margin:20px;">
                    <td>

                        <!--<p style="float:right;margin:8px;"><a style="color:darkblue;" href="/CCMobilePortal/Default.htm"><img style="width:40px; height:35px;" src="/CCMobilePortal/imgs/Web.png"></a> </p><br />-->

                        <p style="font-size:23px;margin:23px 2px;color:#327df5;">
                            <img style="width:40px; height:35px; float:left;" src="/CCMobilePortal/imgs/Web.png">&nbsp;驰骋BPM云-企业注册
                        </p>
                        <div class="layui-form-item">
                            <label class="layui-form-label">管理员手机号：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="TB_Adminer" lay-verify="phone" placeholder="手机号" autocomplete="off" style="margin-bottom: 0px;" class="layui-input">
                            </div>
                            <div class="point">为了您的数据安全，必须使用真实手机号注册.</div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">管理员姓名：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="TB_AdminerName" lay-verify="required" placeholder="您的姓名" style="margin-bottom: 0px;" autocomplete="off" class="layui-input">
                            </div>
                        </div>


                        <div class="layui-form-item">
                            <label class="layui-form-label">密码：</label>
                            <div class="layui-input-inline">
                                <input type="password" name="TB_PassWord" id="TB_PassWord" lay-verify="password" placeholder="至少为3到12位且不能出现空格,全角特殊字符" style="margin-bottom: 0px;" autocomplete="off" class="layui-input">
                            </div>

                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">确认密码：</label>
                            <div class="layui-input-inline">
                                <input type="password" name="TB_PassWord2" lay-verify="password2" placeholder="请确认您的密码" style="margin-bottom: 0px;" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">E-mail：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="TB_Email" lay-verify="email" placeholder="丢失密码可以用e-mail找回." style="margin-bottom: 0px;" autocomplete="off" class="layui-input">
                            </div>
                            <!--<div class="point">
                            </div>-->
                        </div>

                        <div class="layui-form-item">
                            <label style="" class="layui-form-label">企业账号：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="TB_OrgNo" id="TB_OrgNo"  lay-verify="TB_OrgNo" placeholder="必须是3-12位的字母加数字的组合" style="margin-bottom: 0px;" autocomplete="off" class="layui-input">
                            </div>
                            <div class="point">例如:<font color="red"><b>ccsoft</b></font>,您将可以获得二级域名使用PC端登录。 http://<font color="red"><b>ccsoft</b></font>.ccbpm.cn . </div>
                        </div>

                        <!--</fieldset>
                        <fieldset>-->

                        <div class="layui-form-item">
                            <label class="layui-form-label">企业简称：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="TB_OrgName" lay-verify="required"
                                       placeholder="请输入企业简称" style="margin-bottom: 0px;"
                                       autocomplete="off" class="layui-input">
                            </div>
                            <!--<div class="point">例如驰骋BPM</div>-->
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">企业全称：</label>
                            <div class="layui-input-inline">
                                <input type="text" name="TB_OrgNameFull"
                                       lay-verify="required" placeholder="请输入企业全称"
                                       style="margin-bottom: 0px;" autocomplete="off" class="layui-input">
                            </div>
                            <!--<div class="point">例如:济南驰骋信息技术有限公司</div>-->
                        </div>
                        <!-- 提交按钮.... -->
                        <div class="layui-form-item">
                            <div class="layui-input-block" style="width:100%;margin-left:0px;">

                                <button id="Btn_Submit" style="width:100%; background:#327df5;color:#ffffff;font-size:20px" type="button" class="layui-btn" lay-submit="yu" lay-filter="yu">注&nbsp;&nbsp;册</button>

                                <p style="text-align: center; margin:3px;font-size:13px;"><a style="color:darkblue;" href="/CCMobilePortal/Default.htm">已有账号登录</a></p>
                            </div>
                        </div>

                    </td>
                </tr>
            </table>
        </center>

    </form>

    <script type="text/javascript">
        layui.use(['form', 'layedit', 'laydate'], function () {
            var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , laydate = layui.laydate
                , $ = layui.$;




            //自定义验证规则
            form.verify({
                title: function (value) {
                    if (value.length < 5) {
                        return '标题至少得5个字符啊';
                    }
                },
                password2: function (value) {
                    password = $("#TB_PassWord").val();
                    if (value != password) {

                        return "两次输入的密码不一致";
                    }
                },

                password: [
                    /^[\S]{3,12}$/
                    , '密码必须3到12位，且不能出现空格'
                ],
                content: function (value) {
                    layedit.sync(editIndex);
                }
            });

            //监听提交
            form.on('submit(yu)', function (data) {

                Save();
                //layer.alert(JSON.stringify(data.field), {
                //    title: '最终的提交信息'

                //})
                //return;

            });

        });
    </script>
</body>
</html>