<html>
	<head>
		<meta content="IE=10" http-equiv="X-UA-Compatible" />
		<meta http-equiv="content-type" content="text/html;charset=utf-8" />
		<title>首页 - OFFICE文档控件示例</title>
		<link href="officecontrol/ntkoStyle.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="officecontrol/jquery-1.8.2.min.js"></script>
		<script type="text/javascript">
			$(function() {
				var varData = {
					id: "office",
					name: "你的名字"
				};
				$("#param").val(JSON.stringify(varData));
			});

			function openhtml() {
				var strUrl = "office.html";
				var dataSendToChild = $("#param").val();
				var ntkoed = ntkoBrowser.ExtensionInstalled();
				if (ntkoed) {
					ntkoBrowser.openWindow(strUrl, "", "", "", "", "", dataSendToChild);
				} else {
					//没有安装跨浏览器控件的话提示下载安装
					var iTop = ntkoBrowser.NtkoiTop(); //获得窗口的垂直位置;
					var iLeft = ntkoBrowser.NtkoiLeft(); //获得窗口的水平位置;
					window.open("downloadExe.html", "", "height=200px,width=500px,top=" + iTop + "px,left=" + iLeft +
						"px,titlebar=no,toolbar=no,menubar=no,scrollbars=auto,resizeable=no,location=no,status=no");
				}
			}

			//在父页面定义的跨浏览器插件应用程序关闭事件响应方法，且方法名不能自定义，必须是ntkoCloseEvent
			function ntkoCloseEvent() {
				console.log("跨浏览器插件应用程序窗口已关闭!");
			}

			//在父页面定义的用于接收子页面回传值的方法，方法名可以自定义，
			//定义后的方法名需要在子页面中通过window.external.SetReturnValueToParentPage进行注册
			function OnData(callData) {
				var data = decodeURI(callData);
				$("#callback").val(data);
			}
		</script>

	</head>

	<body>
		<script type="text/javascript" src="officecontrol/ntkobackground.min.js"></script>
		<div class="divTitle">
			<div class="divTitle_body">
				<div class="divTitle_caption">OFFICE文档控件 跨浏览器插件 示例</div>
			</div>
		</div>
		<div class="divBody">
			<div class="divBody_Title">
				<div class="divBody_Title_Flag"></div>
				<div class="divBody_Table_Caption"><a href="#" onclick="openhtml()">点击打开文档</a></div>
			</div>
			<table>
				<tr>
					<td style="width:25%;border-bottom-color:#ffffff;" class="divBody_Table_RowTitle">
						要传递到子页面的值
					</td>
					<td>
						<textarea id="param" style="width: 100%;" rows="5"></textarea>
					</td>
				</tr>
				<tr>
					<td style="width:25%;border-bottom-color:#ffffff;" class="divBody_Table_RowTitle">
						子页面关闭时回传的值
					</td>
					<td>
						<textarea id="callback" style="width: 100%;" rows="5"></textarea>
					</td>
				</tr>
			</table>
		</div>
	</body>
</html>
