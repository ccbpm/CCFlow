<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
	<title>延续子流程</title>
	 <link href="../../../Comm/Style/CommStyle.css" rel="stylesheet" type="text/css" />
    <link href="../../../../DataUser/Style/ccbpm.css" rel="stylesheet"  type="text/css" />
    <link href="../../../Scripts/easyUI/themes/default/easyui.css" rel="stylesheet" type="text/css" />
    <link href="../../../Scripts/easyUI/themes/icon.css" rel="stylesheet" type="text/css" />
    <script src="../../../Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="../../../Scripts/easyUI/jquery.easyui.min.js" type="text/javascript"></script>
    <script src="../../../Scripts/QueryString.js" type="text/javascript"></script>
    <script type="text/javascript" src="../../../Scripts/config.js"></script>
    <script type="text/javascript" src="../../../Comm/Gener.js"></script>
    <script src="../../../Scripts/EasyUIUtility.js" type="text/javascript"></script>

	<base target="_self" />
	<script type="text/javascript">

	    //页面启动函数.
	    $(function () {
	        $("#Msg").html("<img src=../../../Img/loading.gif />&nbsp;正在加载,请稍后......");

	        //求出来已经设置的延续子流程.
	        var nodeID = GetQueryString("FK_Node");
	        var orgNo = GetQueryString("OrgNo");

	        //已经选择的岗位.
	        var ens = new Entities("BP.WF.Template.NodeStations");
	        ens.Retrieve("FK_Node", nodeID);

	        //获得该组织的岗位.
	        var stas = new Entities("BP.WF.Port.Stations");
	        stas.Retrieve("OrgNo", orgNo);

	        for (var i = 0; i < stas.length; i++) {

	            var sta = stas[i];
	            var name = sta.Name;
	            var no = sta.No;

	            var typeNo = sta.FK_StationType;
	            var typeName = sta.FK_StationTypeT;
	        }


	        //渲染画面.



	        //	        //获得要增加的流程集合.
	        //	        var dt = DBAccess.RunSQLReturnTable(sql);
	        //	        console.log(dt);

	        //	        var html = "";
	        //	        for (var i = 0; i < dt.length; i++) {

	        //	            var en = dt[i];

	        //	            html += "<tr>";
	        //	            html += "<td><input type=check value='" + en.Name + "' />" + en.SortName + "</td>";
	        //	            html += "<td>" + en.Name + "</td>";
	        //	            html += "</tr>";
	        //	        }

	        //	        $("#Table1 tr:last").after(html);

	    });

        //保存.
	    function Save() {

	        var nodeID = GetQueryString("FK_Node");
	        var orgNo = GetQueryString("OrgNo");

	        //删除,该组织下已经保存的岗位.
	        var sql = "DELETE FROM WF_NodeStation WHERE FK_Station IN (SELECT No FROM Port_Station WHERE OrgNo='" + orgNo + "') AND FK_Node=" + nodeID;
	        DBAccess.RunSQL(sql);

	        //遍历checkbox控件，然后执行插入.
	        for (var i = 0; i < length; i++) {
	            var en = new Entity("BP.WF.Template.NodeStation");
	            en.FK_Node = nodeID;
	            en.FK_Station = "sss";
	            en.Insert();
	        }

	        window.close();
	    }

    </script>
</head>
<body>
	<table id="Table1" style="width: 100%">
        <caption>选择绑定的岗位</caption>

        <tr>
        <th>岗位类别</th>
        <th>名称</th>
        </tr>
		 
	</table>
    <input type=button value="Save" onclick="Save()" />
   
</body>
</html>
