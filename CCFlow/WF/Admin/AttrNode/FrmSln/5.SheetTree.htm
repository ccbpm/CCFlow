<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title> 
    <link href="../../../Comm/Style/Table0.css" rel="stylesheet" type="text/css" />
    <link href="../../../Scripts/easyUI15/themes/icon.css" rel="stylesheet" type="text/css" />
    <link href="../../../Scripts/easyUI15/themes/default/easyui.css" rel="stylesheet" type="text/css" />
     <link href="../../../../DataUser/Style/ccbpm.css" rel="stylesheet"  type="text/css" />
    <script src="../../../Scripts/easyUI15/jquery.min.js" type="text/javascript"></script>
    <script src="../../../Scripts/easyUI15/jquery.easyui.min.js" type="text/javascript"></script>
    <script src="../../../Scripts/QueryString.js" type="text/javascript"></script>
    <script src="../../../Scripts/config.js" type="text/javascript"></script>
    <script src="../../../Comm/JScript.js" type="text/javascript"></script>
    <script src="../../../Scripts/CommonUnite.js" type="text/javascript"></script>
    <script src="../../../Scripts/EasyUIUtility.js" type="text/javascript"></script>
    <script src="../../../Scripts/QueryString.js" type="text/javascript"></script>  
    <script src="../../../Comm/Gener.js" type="text/javascript" ></script>
    <script src="DDLBar.js" type="text/javascript"></script>
    <script src="../../CCFlowEnum.js" type="text/javascript"></script>
    <script  type="text/javascript">
        var nodeID = 0;
        var fk_flow = "";
        $(function () {
            InitBar(FormType.SheetTree);
            var html = "";
            //获取节点属性
            nodeID = GetQueryString("FK_Node");
            var node = new Entity("BP.WF.Node", nodeID);
            fk_flow = node.FK_Flow;
            //表单树.
            if (node.FormType == FormType.SheetTree) {
                document.getElementById("RB_tree").checked = true;
            }

            if (node.FormType == FormType.DisableIt) {
                document.getElementById("RB_tab").checked = true;
            } 

        });

        //绑定/取消绑定
        function BindFrms() {
            var url = "../../Sln/BindFrmsDtl.htm?FK_Node=" + nodeID + "&FK_Flow=" + fk_flow + "&DoType=SelectedFrm";
            OpenEasyUiDialogExt(url, '绑定表单树', 800, 500, false);
        }

        //设置表单字段控件权限
        function BindAttrs() {
            var url = "../../Sln/BindFrms.htm?FK_Node=" + nodeID + "&FK_Flow=" + fk_flow;
            OpenEasyUiDialogExt(url, '绑定列表', 800, 500, false);
        }

        function Save() {
            nodeID = GetQueryString("FK_Node");
            var node = new Entity("BP.WF.Node", nodeID);
            var fromKey = $("input[name='SheetTreeModel']:checked").val();
            if (fromKey == "0") {
                node.FormType = FormType.SheetTree;
            } else {
                node.FormType = FormType.DisableIt;
            }

            node.Update();

            //更新表单类型.
            var frmID = "ND" + nodeID;
            var mapData = new Entity("BP.Sys.MapData", frmID);
            mapData.FrmType = node.FormType;
            mapData.Update();

            alert("保存成功.");
        }

    </script>
</head>
<body >

<div id="bar"> </div>

<fieldset>
    <legend>呈现风格</legend>
    <input type="radio"  value="0" id="RB_tree" name="SheetTreeModel" checked=true /> <label  for="RB_tree" >表单树 </label>
    <input type="radio"  value="1" id="RB_tab"  name="SheetTreeModel" /> <label  for="RB_tab" >Tab标签页 </label>
    [<a href="javascript:BindFrms()" >绑定/取消绑定</a> ] [ <a href="javascript:BindAttrs()" >设置表单字段控件权限</a>]
</fieldset>
<fieldset>
    <legend>说明</legend>
    <font color="gray">
        <ul>
             <li>我们把一个节点需要绑定多个表单的节点称为多表单节点，它有两种展现方式，标签页与表单树。</li>
             <li>对应的流程demo:\\流程树\\表单解决方案\\树形表单与多表单 </li>
        </ul>
    </font>
</fieldset>
</body>
</html>
