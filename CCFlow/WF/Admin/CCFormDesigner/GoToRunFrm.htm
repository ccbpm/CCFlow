<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>转入表单设计器</title>
    <script type="text/javascript" src="../../Scripts/bootstrap/js/jquery.min.js"></script>
    <script type="text/javascript" src="../../Scripts/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../Scripts/QueryString.js"></script>
    <script type="text/javascript" src="../../Scripts/config.js"></script>
    <script type="text/javascript" src="../../Comm/Gener.js"></script>
    <script src="../CCFlowEnum.js"></script>
    <script type="text/javascript" language="javascript">

        //页面启动函数.
        $(function () {

            $("#Msg").html("<h1><img src='../../Img/loading.gif' /> 正在加载请稍后.... </h1>");

            var frmID = GetQueryString("FK_MapData");
            if (frmID == null || frmID == undefined || frmID == "null")
                frmID = GetQueryString("FrmID")

            var url = GetUrl(frmID);
            if (url == null)
            {
                alert("独立表单无法运行");
                return;
            }
            SetHref(url); // "../FoolFormDesigner/Designer.htm?IsFirst=1&FK_MapData" + frmID + "&s=" + Math.random();
            return;
            $("#Msg").html("<font color=blue>" + data + "</font>");
            return;

        });

        function GetUrl(frmID) {

            var md = new Entity("BP.Sys.MapData", frmID);

            if (md.EntityType == EntityType.SingleFrm) {
                return null;
                //if (md.FrmType == FrmType.FreeFrm)
                //    return "../../Comm/En.htm?EnName=BP.WF.Template.Frm.MapFrmFree&No=" + frmID + "&m=" + Math.random();
                //if (md.FrmType == FrmType.ExcelFrm)
                //    return "../../Comm/En.htm?EnName=BP.WF.Template.Frm.MapFrmExcel&No=" + frmID + "&m=" + Math.random();
                //if (md.FrmType == FrmType.Url)
                //    return "../../Comm/En.htm?EnName=BP.WF.Template.Frm.MapDataURL&No=" + frmID + "&m=" + Math.random();
                //return "../../Comm/En.htm?EnName=BP.WF.Template.Frm.MapFrmFool&No=" + frmID + "&m=" + Math.random();
            }

            if (md.EntityType == EntityType.FrmDict)
                return "../../CCBill/SearchDict.htm?FrmID=" + frmID + "&m=" + Math.random();

            if (md.EntityType == EntityType.FrmBill)
                return "../../CCBill/SearchBill.htm?FrmID=" + frmID + "&m=" + Math.random();

            if (md.EntityType == EntityType.EntityTree)
                return "../../CCBill/SearchDict.htm?FrmID=" + frmID + "&m=" + Math.random();
             //   return "../../Comm/En.htm?EnName=BP.CCBill.FrmBill&No=" + frmID + "&m=" + Math.random();

            return null;
        }
    </script>
</head>
<body>
    <br />
    <br />
    <br />
    <center>

        <div id="Msg"> </div>
    </center>
</body>
</html>
