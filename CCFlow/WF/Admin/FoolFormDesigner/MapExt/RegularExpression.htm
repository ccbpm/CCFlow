<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
       <script type="text/javascript" src="../../../Scripts/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="../../../Scripts/QueryString.js"></script>
    <script type="text/javascript" src="../../../Scripts/config.js"></script>

    <link href="../../../../DataUser/Style/Table0.css" rel="stylesheet" />
    <script type="text/javascript">

        var sys_mapExt = null;
        var RE = null;
        var REDtl = null;


        $(function () {

            var fk_mapdata = GetQueryString["FK_MapData"]; //表单id.
            var keyOfEn = GetQueryString["RefNo"]; //字段

            $.ajax({
                type: 'post',
                async: true,
                url: Handler + "?DoType=RegularExpression_Init&FK_MapData=" + fk_mapdata + "&KeyOfEn=" + keyOfEn + "&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {

                    if (data == "")
                        return;

                    alert(data);

                    data = JSON.parse(data);

                    sys_mapExt = data['Sys_MapExt']; // 已经保存的模版.
                    RE = data['RE']; //模版列表.
                    REDtl = data['REDtl']; //模版的详细信息.

                    for (var i = 0; i < RE.length; i++) {
                        var newRow = "<tr><td style='bgcolor:red'>" + RE[i].No + "</td><td class=BigDoc><a href=\"Select('"+RE[i].No+"')\" >" + RE[i].Name + "</a> </td></tr>";
                        $("#Table1 tr:last").after(newRow);
                    }

                },
                error: function (xml, textSta, errorThrown) {
                    alert(xml);
                    alert(textSta);
                    alert(errorThrown);
                }
            })
        })

        function Select(id) {

            for (var i = 0; i < REDtl.length; i++) {
                if (REDtl[i].ItemNo != id)
                    continue;
                var ev = REDtl[i].ForEvent;
                $("#TB_Doc_" + ev).val(REDtl[i].Exp);
             }
        }

        function Save() {

            var frmData = $("#cc").serialize();

            //初始化表格.
            $.ajax({
                data: frmData,
                type: 'post',
                async: true,
                url: Handler + "?DoType=RegularExpression_Save&FK_MapData=" + GetQueryString("FK_MapData") + "&KeyOfEn=" + GetQueryString("RefNo") + "&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {
                    if (data.indexOf('err@') == 0) {
                        alert(data);
                        return;
                    }
                    alert(data);
                }
            });
        }


    </script>
    <style type="text/css">
        .style1
        {
            padding: 4px;
            margin: 4px;
            background-color: #e0ecff;
            font-size: 12px;
            border: 1px solid #ccc;
            text-align: left;
            word-break: keep-all;
            font-weight: bold;
            color: #0e2d5f;
            width: 90px;
        }
        .style2
        {
            width: 90px;
        }
    </style>
</head>
<body>

 <Table class='Table' cellpadding='0' cellspacing='0' border='0' style='width:100%' >

<caption  >为字段[""]设置正则表达式.<div style='float:right' ><a href='http://ccform.mydoc.io/?v=5769&t=36728' target=_blank><img src='/WF/Img/Help.gif'>正则表达式-帮助</a></div></Caption>
<TR>
<TD class='GroupTitle'>序</TD>
<TD class='style1' >事件</TD>
<TD class='GroupTitle' >事件内容</TD>
<TD class='GroupTitle' >提示信息</TD>
</TR>
<TR>
<TD class='Idx' >1</TD>
<TD style='font-size:12px' class="style2" >onblur</TD>
<TD ><textarea name="TB_Doc_onblur" rows="1" cols="50" id="TB_Doc_onblur" style="width:99%;"></textarea></TD>
<TD ><input name="TB_Tag1_onblur" type="text" value="" size="20" id="TB_Tag1_onblur" style="width:99%;" /></TD>
</TR>
<TR>
<TD class='Idx' >2</TD>
<TD style='font-size:12px' class="style2" >onchange</TD>
<TD ><textarea name="TB_Doc_onchange" rows="1" cols="50" id="TB_Doc_onchange" style="width:99%;">
</textarea></TD>
<TD ><input name="TB_Tag1_onchange" type="text" size="20" id="TB_Tag1_onchange" style="width:99%;" /></TD>
</TR>
<TR>
<TD class='Idx' >3</TD>
<TD style='font-size:12px' class="style2" >onclick</TD>
<TD ><textarea name="TB_Doc_onclick" rows="1" cols="50" id="TB_Doc_onclick" style="width:99%;">
</textarea></TD>
<TD ><input name="TB_Tag1_onclick" type="text" size="20" id="TB_Tag1_onclick" style="width:99%;" /></TD>
</TR>
<TR>
<TD class='Idx' >4</TD>
<TD style='font-size:12px' class="style2" >ondblclick</TD>
<TD ><textarea name="TB_Doc_ondblclick" rows="1" cols="50" id="TB_Doc_ondblclick" style="width:99%;">
</textarea></TD>
<TD ><input name="TB_Tag1_ondblclick" type="text" size="20" id="TB_Tag1_ondblclick" style="width:99%;" /></TD>
</TR>
<TR>
<TD class='Idx' >5</TD>
<TD style='font-size:12px' class="style2" >onkeypress</TD>
<TD ><textarea name="TB_Doc_onkeypress" rows="1" cols="50" id="TB_Doc_onkeypress" style="width:99%;">
</textarea></TD>
<TD ><input name="TB_Tag1_onkeypress" type="text" size="20" id="TB_Tag1_onkeypress" style="width:99%;" /></TD>
</TR>
<TR>
<TD class='Idx' >6</TD>
<TD style='font-size:12px' class="style2" >onkeyup</TD>
<TD ><textarea name="TB_Doc_onkeyup" rows="1" cols="50" id="TB_Doc_onkeyup" style="width:99%;">
</textarea></TD>
<TD ><input name="TB_Tag1_onkeyup" type="text" size="20" id="TB_Tag1_onkeyup" style="width:99%;" /></TD>
</TR>
<TR>
<TD class='Idx' >7</TD>
<TD style='font-size:12px' class="style2" >onsubmit</TD>
<TD ><textarea name="TB_Doc_onsubmit" rows="1" cols="50" id="TB_Doc_onsubmit" style="width:99%;">
/^\d{15}|\d{}18$/</textarea></TD>
<TD ><input name="TB_Tag1_onsubmit" type="text" value="" size="20" id="TB_Tag1_onsubmit" style="width:99%;" /></TD>
</TR></Table>

<input type="button" id="Btn_Save"  name="Btn_Save" value="保存"  onclick="Save()" /> 
<input type="button" id="Btn_LoadTemplate"  name="Btn_LoadTemplate" value="加载模版"  onclick="LoadTemplate()" />
<script type="text/javascript">

function LoadTemplate() {
    var div = document.getElementById("template");
}
</script>

<div id="template">

<table id="Table1" >
<tr>
<th> 序号 </th>
<th> 名称 </th>
<th> 内容 </th>
</tr>

</table>

</div>

</body>
</html>
