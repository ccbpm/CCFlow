<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
     <script type="text/javascript" src="../../../Scripts/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="../../../Scripts/QueryString2016.js"></script>
    <link href="../../../../DataUser/Style/ccbpm.css" rel="stylesheet" />
    <script src="../../../Scripts/config.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("table tr:gt(0)").hover(
                function () { $(this).addClass("tr_hover"); },
                function () { $(this).removeClass("tr_hover"); });
        });

        //上移
        function up(obj, idxTBColumnIdx) {
            var objParentTR = $(obj).parent().parent();
            var prevTR = objParentTR.prev();
            var currTrId;
            var prevTrId;
            if (prevTR.length > 0 && !isNaN(prevTR.children(":eq(0)").text())) {
                prevTR.insertAfter(objParentTR);
                currTrId = Number(objParentTR.children(":eq(0)").text());
                prevTrId = Number(prevTR.children(":eq(0)").text());
                objParentTR.children(":eq(0)").text(prevTrId);
                prevTR.children(":eq(0)").text(currTrId);
                objParentTR.children(":eq(" + idxTBColumnIdx + ")").children(":first").val(prevTrId);
                prevTR.children(":eq(" + idxTBColumnIdx + ")").children(":first").val(currTrId);
            } else {
                return;
            }
        }
        //下移
        function down(obj, idxTBColumnIdx) {
            var objParentTR = $(obj).parent().parent();
            var nextTR = objParentTR.next();
            var currTrId;
            var nextTrId;
            if (nextTR.length > 0 && !isNaN(nextTR.children(":eq(0)").text())) {
                nextTR.insertBefore(objParentTR);
                currTrId = Number(objParentTR.children(":eq(0)").text());
                nextTrId = Number(nextTR.children(":eq(0)").text());
                objParentTR.children(":eq(0)").text(nextTrId);
                nextTR.children(":eq(0)").text(currTrId);
                objParentTR.children(":eq(" + idxTBColumnIdx + ")").children(":first").val(nextTrId);
                nextTR.children(":eq(" + idxTBColumnIdx + ")").children(":first").val(currTrId);
            } else {
                return;
            }
        }
    </script>
    <script language="javascript" type="text/javascript" >

        //页面启动函数.
        $(function () {

            $("#Msg").html("<img src=../../../Img/loading.gif />&nbsp;正在加载,请稍后......");

            InitPage();

            $("#Msg").html("");

        });

        function InitPage() {

            var rptNo = unescape(GetQueryString("RptNo"));
            var flowNo = unescape(GetQueryString("FK_Flow"));

            $.ajax({
                type: 'post',
                async: true,
                url: Handler + "?DoType=S3ColsLabel_Init&RptNo=" + rptNo + "&FK_Flow=" + flowNo + "&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {

                    if (data.indexOf("@") == 0) {
                        alert(data);
                        return;
                    }
                    alert(data);
                    //var jsData = JSON.parse(data);
                    //var Sys_MapAttr = jsData["Sys_MapAttr"]; //所有的列.

                    //输出列.

                }
            });
        }

        function Save() {

            var fk_flow = GetQueryString("FK_Flow");
            var rptNo = GetQueryString("RptNo");

            $.ajax({
                type: 'post',
                async: true,
                url: Handler + "?DoType=S3ColsLabel_Save&FK_Flow=" + fk_flow + "&RptNo=" + rptNo + "&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {

                    alert(data)
                    if (window.opener != null) {
                        //刷新父窗口
                        window.opener.location.reload();
                    }
                    window.close();
                }
            });
        }

        function Cancel() {
            window.close();
        }
    </script>
    <base target="_self" /> 
</head>
<body onkeypress="Esc()" >

<form name='cc' id='cc'>

  <table class='Table' cellpadding='0' cellspacing='0' style='width: 60%;'>
  <caption>报表属性编辑</caption>
        <tr>
            <td style=" width:30%;" >
                编号:
            </td>
            <td>
                <input type="text" id="TB_No" /><br />默认报表编号为:ND**MyRpt ,建议报表编号向后推：如ND20MyRpt1，ND20MyRpt2
            </td>
        </tr>
        <tr>
            <td >
                名称:
            </td>
            <td>
                <input type="text" id="TB_Name"/>
            </td>
        </tr>
        <tr>
            <td >
                备注:
            </td>
            <td>
                <input type="text" id="TB_Note"/>
            </td>
        </tr>
    </table>
    <br />

    <input type="button" id="Btn_Save" name="Btn_Save" value="保存" onclick="Save()" />

</form>

</body>
</html>
