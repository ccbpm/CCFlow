
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head >

    <title>驰骋工作流引擎登录</title>
    <link href="../../DataUser/Style/ccbpm.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../Scripts/bootstrap/js/jquery.min.js"></script>
    <script type="text/javascript" src="../Scripts/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../Scripts/bootstrap/js/jquery.min.js"></script>
    <script src="../Scripts/config.js" type="text/javascript"></script>
    <script src="../Scripts/easyUI/jquery-1.8.0.min.js" type="text/javascript"></script>
    <script src="../Scripts/QueryString.js" type="text/javascript"></script>

    <!-- 引用通用的js文件. -->
    <script type="text/javascript" src="../Comm/Gener.js"></script>
    <script type="text/javascript" src="../Scripts/config.js"></script>
    <script type="text/javascript" language="javascript" >
        //页面启动函数.
        $(function () {

            $("#Msg").html("<img src='../Img/loading.gif' /><font color=blue>ccbpm 正在为登做准备.</font>");

            $.ajax({
                type: 'post',
                async: true,
                url: Handler + "?DoType=Login_Init&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {

                    if (data.indexOf('err@') == 0) {
                        alert(data);
                        return;
                    }

                    data = JSON.parse(data);

                    //调用公共类库的方法:执行批量主表赋值
                    GenerFullAllCtrlsVal(data);

                    $("#Msg").html("<font color=blue>ccbpm 欢迎登录...</font>");
                    return;
                }
            });
        });

        function Login_Submit() {

            var userNo = document.getElementById("TB_UserNo").value;
            var userPass = document.getElementById("TB_Pass").value;

            if (userNo == "" || userPass == "") {
                alert('请输入用户名与密码');
                return;
            }

            $("#Msg").html("<img src='../Img/loading.gif' /><font color=blue>ccbpm 正在登录请稍候....</font>");

            //执行登录..
            $.ajax({
                type: 'post',
                async: true,
                url: Handler + "?DoType=Login_Submit&TB_UserNo=" + userNo + "&TB_Pass=" + userPass + "&m=" + Math.random(),
                dataType: 'html',
                success: function (data) {
                    if (data.indexOf('err@') == 0) {
                        $("#Msg").html("<font color=red>"+data+"</font>");
                        return;
                    }
                    window.location.href = 'Home.htm';
                }
            });
        }
    </script>

</head>
<body>
    <form id="cc" runat="server">


    <div style="text-align:center">

<h2>用户登录</h2>
   <fieldset>
    <legend> ccflow登录的API在Button事件后面 </legend>
    <br/>
  用户名:  <input type="text" id="TB_UserNo" name="TB_UserNo"  />
    <br/>
  密码： <input type="password" id="TB_Pass" name="TB_Pass"  /> 

  <input type="button" value="登录" onclick="Login_Submit()" />
    <font color="gray" > 默认密码为:123 或者 pub</font>
    <br/>
    <br/>
    </fieldset>

    <fieldset>
    <legend>说明:</legend>
    <ul>
     <li>1, 登录界面是有您来编写的。 </li>
     <li>2, 密码的验证，登录前后要处理的业务逻辑均有您来开发。 </li>
     <li>3, 验证成功后，就调用ccflow的登录API。 </li>
     <li>4, 点击这里<a href="../Admin/CCBPMDesigner/Login.htm" >登录流程设计器</a>。</li>
    </ul>
    </fieldset>
    </div>

    <div id="Msg" />

    </form>
</body>
</html>
