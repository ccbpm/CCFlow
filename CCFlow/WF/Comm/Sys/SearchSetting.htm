<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>基本设置</title>
    <script type="text/javascript" src="../../Scripts/bootstrap/js/jquery.min.js"></script>
    <script src="../../Scripts/QueryString.js" type="text/javascript"></script>
    <script type="text/javascript" src="../../Scripts/config.js"  ></script>
    <script src="../../Comm/Gener.js?va2=2" type="text/javascript"></script>
    <link href="../../../DataUser/Style/ccbpm.css" rel="Stylesheet" />
    <script type="text/javascript">

        //页面启动函数.
        $(function () {

            var ensName = GetQueryString("EnsName");

            //全局配置.
            var en = new Entity("BP.Sys.EnCfg");
            en.No = ensName;
            if (en.IsExits() == false) {

                en.SetPara("UIRowStyleGlo", 1); //表格数据行风格(应用全局)
                en.SetPara("IsEnableDouclickGlo", 1); //是否启动双击打开(应用全局)
                en.SetPara("IsEnableFocusField", 0); //是否启用焦点字段
                en.SetPara("FocusField", "无"); //焦点字段(用于显示点击打开的列
                en.SetPara("IsEnableRefFunc", 1); //是否启用相关功能列

                en.SetPara("IsEnableOpenICON", 1); //是否启用打开图标
                en.SetPara("MoveToShowWay", 0); //移动到显示方式
                en.SetPara("MoveTo", "无"); //是否启用相关功能列
                en.SetPara("WinCardW", "1000"); //是否启用相关功能列
                en.SetPara("WinCardH", "600"); //是否启用相关功能列

                en.SetPara("EditerType", 0); //是否启用相关功能列

                //打开url类型. 
                en.SetPara("SearchUrlOpenType", "0"); //默认为打开En.htm
                en.Url = "";
                en.Insert();
            }

            var en = new Entity("BP.Sys.EnCfg");
            en.No = ensName;
            en.Retrieve();

            //赋值.
            GenerBindEnumKey("DDLPara_UIRowStyleGlo", "UIRowStyleGlo");
            GenerBindEnumKey("DDLPara_MoveToShowWay", "MoveToShowWay");
            GenerBindEnumKey("DDLPara_EditerType", "EditerType");

            //双击行打开内容类型.
          //  GenerBindEnumKey("DDLPara_SearchUrlOpenType", "SearchUrlOpenType", 0);

            //给页面的控件赋值.
            GenerFullAllCtrlsVal(en);

        });

        function Save() {

            var ensName = GetQueryString("EnsName");
            //全局配置.
            var en = new Entity("BP.Sys.EnCfg", ensName);
            en.CopyForm(); //从from里面copy数据.
            en.No = ensName;
            en.Update();

            window.location.href = window.location.href;
        }

        function ShowCols() {
            var url = "SearchSettingCols.htm?EnsName=" + GetQueryString("EnsName");
            window.location.href = url;
        }

        function StartFoolFormDesigner() {
            var url = "../../Admin/FoolFormDesigner/Designer.htm?FK_MapData=" + GetQueryString("EnsName") + "&IsFirst=1";
            WinOpen(url, "dd");
            //window.location.href = url;
        }

        //导入设置.
        function Imp() {
            var url = "ImpData.htm?EnsName=" + GetQueryString("EnsName");
            window.location.href = url;
        }

        //清除傻瓜表达设计内容
        function ClearMapData() {
            var alt = "如果您确定要删除吗？";
            alt += "\t\n1. 系统会清除Sys_MapAttr, Sys_MapData设计内容，包括排列顺序. ";
            alt += "\t\n2. 清除后您可以通过启动傻瓜表单设计器. ";
            if (confirm(alt) == false)
                return;

            var ensName = GetQueryString("EnsName");
            var mapdata = new Entity("BP.Sys.MapData");
            mapdata.SetPKVal(ensName);
            mapdata.Delete();

            alert("清除成功.");

        }

    </script>
</head>
<body>
<table style="width:96%;">
<caption>基本设置</caption>
<tr>
<th >配置项</th>
<th>内容</th>
<th>信息</th>
</tr>

<tr bgcolor='white' >
<td>UIRowStyleGlo</td>
<td>表格数据行风格(应用全局)</td>
<td ><select name="DDLPara_UIRowStyleGlo" id="DDLPara_UIRowStyleGlo">
</select></td>
</tr>

<tr bgcolor='AliceBlue' >
<td>IsEnableDouclickGlo</td>
<td>是否启动双击打开(应用全局)</td>
<td ><label ><input id="CBPara_IsEnableDouclickGlo" type="checkbox" name="CBPara_IsEnableDouclickGlo" />是否启动双击打开(应用全局)</label></td>
</tr>

<tr bgcolor='white' >
<td>IsEnableFocusField</td>
<td>是否启用焦点字段</td>
<td ><label ><input id="CBPara_IsEnableFocusField" type="checkbox" name="CBPara_IsEnableFocusField"  />是否启用焦点字段</label></td>
</tr>

<tr bgcolor='AliceBlue' >
<td>FocusField</td>
<td>焦点字段(用于显示点击打开的列</td>
<td ><input name="TBPara_FocusField" type="text" value="" id="TBPara_FocusField" style="width:100%;" /></td>
</tr>
<tr bgcolor='white' >
<td>IsEnableRefFunc</td>
<td>是否启用相关功能列</td>
<td ><label ><input id="CBPara_IsEnableRefFunc" type="checkbox" name="CBPara_IsEnableRefFunc"  />是否启用相关功能列</label></td>
</tr>
<tr bgcolor='AliceBlue' >
<td>IsEnableOpenICON</td>
<td>是否启用打开图标</td>
<td ><label ><input id="CBPara_IsEnableOpenICON" type="checkbox" name="CBPara_IsEnableOpenICON"  />是否启用打开图标</label></td>
</tr>
<tr bgcolor='white' >
<td>MoveToShowWay</td>
<td>移动到显示方式</td>
<td ><select name="DDLPara_MoveToShowWay" id="DDLPara_MoveToShowWay">
</select></td>
</tr>
<tr bgcolor='AliceBlue' >
<td>MoveTo</td>
<td>移动到字段</td>
<td ><input name="TBPara_MoveTo" type="text" id="TBPara_MoveTo" style="width:100%" /></td>
</tr>
<tr bgcolor='white' >
<td>WinCardW</td>
<td>弹出窗口宽度</td>
<td ><input name="TBPara_WinCardW" type="text"  id="TBPara_WinCardW" style="width:100%" /></td>
</tr>

<tr bgcolor='AliceBlue' >
<td>WinCardH</td>
<td>弹出窗口高度</td>
<td ><input name="TBPara_WinCardH" type="text"  id="TBPara_WinCardH" style="width:100%" /></td>
</tr>

<tr bgcolor='white' >
<td>EditerType</td>
<td>大块文本编辑器</td>
<td ><select name="DDLPara_EditerType" id="DDLPara_EditerType">
</select></td>
</tr>


<tr bgcolor='AliceBlue' >
<td>UrlOpenType</td>
<td>双击行打开内容</td>
<td ><select name="DDLPara_SearchUrlOpenType" id="DDLPara_SearchUrlOpenType">
<option value="0"> En.htm 实体与实体相关功能编辑器 </option>
<option value="1"> EnOnly.htm 实体编辑器 </option>
<option value="2"> /CCForm/FrmGener.htm 傻瓜表单解析器 </option>
<option value="3"> /CCForm/FrmGener.htm 自由表单解析器 </option>
<option value="9"> 自定义URL </option>
</select></td>
</tr>

<tr>
<td>WinOpenUrl</td>
<td>URL(当为自定义url的时候有效)</td>
<td ><input name="TB_Url" type="text" value="" id="TB_Url" style="width:100%;" /></td>
</tr>
</table>

<input type="button" value="保存"  onclick="Save()" />
<input type="button" value="设置显示的列"  onclick="ShowCols()" />
<input type="button" value="启动傻瓜表单设计器"  onclick="StartFoolFormDesigner()" />
<input type="button" value="清除表单设计内容"  onclick="ClearMapData()" />
<input type="button" value="导入数据"  onclick="Imp()" />

</body>
</html>
