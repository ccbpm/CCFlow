<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="../../Scripts/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../../Scripts/QueryString.js"></script>
    <script type="text/javascript" src="../../Scripts/config.js"></script>
    <script type="text/javascript" src="../../Comm/Gener.js"></script>

    <script src="../../Scripts/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <link href="../../Scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../../Scripts/bootstrap/css/font-awesome.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/bootstrap/bootstrap-table/src/bootstrap-table.js" type="text/javascript"></script>
    <link href="../../Scripts/bootstrap/bootstrap-table/src/bootstrap-table.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/bootstrap/bootstrap-table/src/locale/bootstrap-table-zh-CN.js" type="text/javascript"></script>

    <script src="../../Scripts/bootstrap/bootstrap-treeview/src/js/bootstrap-treeview.js" type="text/javascript"></script>
    <link href="../../Scripts/bootstrap/bootstrap-treeview/src/css/bootstrap-treeview.css" rel="stylesheet" type="text/css" />
    <style>
        ul li {
            list-style: none;
        }

        a, a:hover {
            text-decoration: none;
        }
    </style>
    <script type="text/javascript">

        $(function () {
            var webUser = new WebUser();


            var tps = new Entities("BP.Port.StationTypes");
            tps.RetrieveAll();

            var stas = new Entities("BP.Port.Stations");
            stas.RetrieveAll();

            var html = "<ul>";

            for (var idx = 0; idx < tps.length; idx++) {
                var tp = tps[idx];

                html += "<li>" + tp.Name;

                html += "<ul>";
                for (var i = 0; i < stas.length; i++) {
                    var sta = stas[i];
                    if (sta.FK_StationType != tp.No)
                        continue;

                    html += "<li><a href='#' onclick=ShowEmp('" + sta.No + "') id='" + sta.No + "' >" + sta.Name + "</a></li>";
                }
                html += "</ul>";

                html += "</li>";
            }
            html += "</ul>";

            $("#stationsList").append(html);

        });

        //显示人员.
        function ShowEmp(StationNo) {
            
            $("#stationsEmpList").html("");
            var handler = new HttpHandler("BP.WF.HttpHandler.WF_WorkOpt_Selecter");
            handler.AddPara("StaNo",StationNo);
            var data = handler.DoMethodReturnString("ByStation_ShowEmps");
            var Emps = eval('(' + data + ')');
            var html = "";
            html += "<ul>";
            for (var i = 0; i < Emps.length; i++) {
                en = Emps[i];
               
                var en = new Entity("BP.Port.Emp", en.No);

                html += "<a href='#'><li><input onclick=SelectEmp('" + (en.No) + "') id='" + en.No + "' type='checkbox'>&nbsp&nbsp" + en.Name + "</li></a>";
            }

            html += "</ul>"
            $("#stationsEmpList").append(html);
        }
        function SelectEmp(EmpNo) {
           var en = new Entity("BP.Port.Emp", EmpNo);
            if (document.getElementById(EmpNo).checked) {
                var html = "";
                html += "<ul>";
                html += "<li id='" + en.Name + "'>" + en.Name + "</li>";
                html += "</ul>"
                $("#selectEmpList").append(html);
            }
            else {
                document.getElementById(en.Name).remove();
            }
        }
    </script>

</head>
<body>

    <a onclick=""></a>
    <table class="table table-bordered" style="border:1px; border-color:black ">
        <tr>
            <td>(@)按岗位 ()<a href="ByTeam.htm">按用户组</a> </td>
            <td>关键字:____ 查询 关闭 </td>
        </tr>
        <tr>
            <td id="stationsList" rowspan="2">
            </td>
            <td id="stationsEmpList">
            </td>
        </tr>
        <tr>
            <td id="selectEmpList" rowspan="2"></td>

        </tr>

    </table>

</body>
</html>
