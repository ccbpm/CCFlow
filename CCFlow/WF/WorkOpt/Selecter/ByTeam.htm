<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="../../Scripts/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../../Scripts/QueryString.js"></script>
    <script type="text/javascript" src="../../Scripts/config.js"></script>
    <script type="text/javascript" src="../../Comm/Gener.js"></script>

    <script src="../../Scripts/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <link href="../../Scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../../Scripts/bootstrap/css/font-awesome.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/bootstrap/bootstrap-table/src/bootstrap-table.js" type="text/javascript"></script>
    <link href="../../Scripts/bootstrap/bootstrap-table/src/bootstrap-table.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/bootstrap/bootstrap-table/src/locale/bootstrap-table-zh-CN.js" type="text/javascript"></script>

    <script src="../../Scripts/bootstrap/bootstrap-treeview/src/js/bootstrap-treeview.js" type="text/javascript"></script>
    <link href="../../Scripts/bootstrap/bootstrap-treeview/src/css/bootstrap-treeview.css" rel="stylesheet" type="text/css" />
    <style>
        ul li {
            list-style: none;
        }

        a, a:hover {
            text-decoration: none;
        }
    </style>
    <script type="text/javascript">

        $(function () {
            var tps = new Entities("BP.Port.TeamTypes");
            tps.RetrieveAll();

            var teams = new Entities("BP.Port.Teams");
            teams.RetrieveAll();

           var html = "<ul>";

            for (var idx = 0; idx < tps.length; idx++) {
                var tp = tps[idx];

                html += "<li>" + tp.Name;

                html += "<ul>";
                for (var i = 0; i < teams.length; i++) {
                    var team = teams[i];
                    if (team.FK_TeamType != tp.No)
                        continue;

                    html += "<li><a href='#' onclick=ShowEmp('" + team.No + "') id='" + team.No + "' >" + team.Name + "</a></li>";
                }
                html += "</ul>";

                html += "</li>";
            }
            html += "</ul>";
            $("#teamsList").append(html);
        });
        function ShowEmp(TeamNo) {
           
            $("#teamsEmpList").html("");
            var handler = new HttpHandler("BP.WF.HttpHandler.WF_WorkOpt_Selecter");
            handler.AddPara("TeamNo",TeamNo);
            var data = handler.DoMethodReturnString("SelectEmpsByTeamStation_Init");
            
            var Emps = eval('(' + data + ')');
            var html = "";
            html += "<ul>";
            for (var i = 0; i < Emps.length; i++) {
                en = Emps[i];
               
                var en = new Entity("BP.Port.Emp", en.No);

                html += "<a href='#'><li><input onclick=SelectEmp('" + (en.No) + "') id='" + en.No + "' type='checkbox'>&nbsp&nbsp" + en.Name + "</li></a>";
            }

            html += "</ul>"
            $("#teamsEmpList").append(html);
        }
        function SelectEmp(EmpNo) {
             var en = new Entity("BP.Port.Emp", EmpNo);
            if (document.getElementById(EmpNo).checked) {
                var html = "";
                html += "<ul>";
                html += "<li id='" + en.Name + "'>" + en.Name + "</li>";
                html += "</ul>"
                $("#selectEmpList").append(html);
            }
            else {
                document.getElementById(en.Name).remove();
            }
        }
        function GotoUrl() {
            var url = "ByStation.htm?WorkID=" + GetQueryString("WorkID") + "&ToNode=" + GetQueryString("ToNode");
            window.location.href = url;
        }
    </script>

</head>
<body>


    <table class="table table-bordered" style="border:1px; border-color:black ">
        <tr>
            <td><a onclick="GotoUrl()" href="#">()按用户组</a> (@)按用户组 </td>
            <td>关键字:____查询 关闭 </td>
        </tr>

        <tr>
            <td id="teamsList" rowspan="2">
            </td>
            <td id="teamsEmpList">
            </td>
        </tr>
        <tr>
            <td id="selectEmpList" rowspan="2"></td>

        </tr>

    </table>

</body>
</html>